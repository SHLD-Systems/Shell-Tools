#!/bin/bash

set -euo pipefail

# Default values
CIPHER="aes-256-cbc"

# Check mandatory argument: password
if [[ $# -lt 1 ]]; then
    echo "Usage: encrypt.sh password [-c cipher]"
    echo "Available ciphers: aes-256-cbc, aes-192-cbc, aes-128-cbc"
    exit 1
fi

PASSWORD="$1"
shift

# Parse optional arguments
while [[ $# -gt 0 ]]; do
    case "$1" in
        -c|--cipher)
            CIPHER="$2"
            shift 2
            ;;
        -h|--help)
            echo "Usage: encrypt.sh password [-c cipher]"
            echo "Available ciphers: aes-256-cbc, aes-192-cbc, aes-128-cbc"
            exit 0
            ;;
        *)
            echo "Unknown option: $1" >&2
            exit 1
            ;;
    esac
done

# Encrypt the stream
openssl enc -"${CIPHER}" -salt -pbkdf2 -pass pass:"${PASSWORD}"

